<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 3 Species observation distributions | Supplementary material for: Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient</title>
  <meta name="description" content="Supplementary material for ‘Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient’" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 3 Species observation distributions | Supplementary material for: Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Supplementary material for ‘Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient’" />
  <meta name="github-repo" content="pratikunterwegs/ebird-wghats-supplement" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 3 Species observation distributions | Supplementary material for: Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient" />
  
  <meta name="twitter:description" content="Supplementary material for ‘Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient’" />
  

<meta name="author" content="Vijay Ramesh, Pratik R Gupte, and Morgan Tingley" />


<meta name="date" content="2020-07-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="distance-to-roads.html"/>
<link rel="next" href="climate-in-relation-to-elevation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distance-to-roads.html"><a href="distance-to-roads.html"><i class="fa fa-check"></i><b>2</b> Distance to roads</a><ul>
<li class="chapter" data-level="2.1" data-path="distance-to-roads.html"><a href="distance-to-roads.html#prepare-libraries"><i class="fa fa-check"></i><b>2.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="2.2" data-path="distance-to-roads.html"><a href="distance-to-roads.html#prepare-data-for-processing"><i class="fa fa-check"></i><b>2.2</b> Prepare data for processing</a></li>
<li class="chapter" data-level="2.3" data-path="distance-to-roads.html"><a href="distance-to-roads.html#species-specific-nearest-sites"><i class="fa fa-check"></i><b>2.3</b> Species specific nearest sites</a></li>
<li class="chapter" data-level="2.4" data-path="distance-to-roads.html"><a href="distance-to-roads.html#explicit-spatial-filter"><i class="fa fa-check"></i><b>2.4</b> Explicit spatial filter</a></li>
<li class="chapter" data-level="2.5" data-path="distance-to-roads.html"><a href="distance-to-roads.html#species-specific-filter"><i class="fa fa-check"></i><b>2.5</b> Species specific filter</a></li>
<li class="chapter" data-level="2.6" data-path="distance-to-roads.html"><a href="distance-to-roads.html#plot-histogram-distance-to-roads"><i class="fa fa-check"></i><b>2.6</b> Plot histogram: distance to roads</a></li>
<li class="chapter" data-level="2.7" data-path="distance-to-roads.html"><a href="distance-to-roads.html#table-distance-to-roads"><i class="fa fa-check"></i><b>2.7</b> Table: Distance to roads</a></li>
<li class="chapter" data-level="2.8" data-path="distance-to-roads.html"><a href="distance-to-roads.html#plot-histogram-distance-to-nearest-site"><i class="fa fa-check"></i><b>2.8</b> Plot histogram: distance to nearest site</a></li>
<li class="chapter" data-level="2.9" data-path="distance-to-roads.html"><a href="distance-to-roads.html#plot-species-specific-histograms-distance-to-nearest-site"><i class="fa fa-check"></i><b>2.9</b> Plot species specific histograms: distance to nearest site</a></li>
<li class="chapter" data-level="2.10" data-path="distance-to-roads.html"><a href="distance-to-roads.html#table-species-specific-nearest-site"><i class="fa fa-check"></i><b>2.10</b> Table: Species specific nearest site</a></li>
<li class="chapter" data-level="2.11" data-path="distance-to-roads.html"><a href="distance-to-roads.html#plot-map-points-on-roads"><i class="fa fa-check"></i><b>2.11</b> Plot map: points on roads</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html"><i class="fa fa-check"></i><b>3</b> Species observation distributions</a><ul>
<li class="chapter" data-level="3.1" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html#prepare-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="3.2" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html#read-species-of-interest"><i class="fa fa-check"></i><b>3.2</b> Read species of interest</a></li>
<li class="chapter" data-level="3.3" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html#load-raw-data-for-locations"><i class="fa fa-check"></i><b>3.3</b> Load raw data for locations</a></li>
<li class="chapter" data-level="3.4" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html#get-proportional-obs-counts-in-25km-cells"><i class="fa fa-check"></i><b>3.4</b> Get proportional obs counts in 25km cells</a></li>
<li class="chapter" data-level="3.5" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html#which-species-are-reported-sufficiently-in-checklists"><i class="fa fa-check"></i><b>3.5</b> Which species are reported sufficiently in checklists?</a></li>
<li class="chapter" data-level="3.6" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html#plot-maps"><i class="fa fa-check"></i><b>3.6</b> Plot maps</a></li>
<li class="chapter" data-level="3.7" data-path="species-observation-distributions.html"><a href="species-observation-distributions.html#write-the-new-list-of-species"><i class="fa fa-check"></i><b>3.7</b> Write the new list of species</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-in-relation-to-elevation.html"><a href="climate-in-relation-to-elevation.html"><i class="fa fa-check"></i><b>4</b> Climate in relation to elevation</a><ul>
<li class="chapter" data-level="4.1" data-path="climate-in-relation-to-elevation.html"><a href="climate-in-relation-to-elevation.html#prepare-libraries-2"><i class="fa fa-check"></i><b>4.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="4.2" data-path="climate-in-relation-to-elevation.html"><a href="climate-in-relation-to-elevation.html#plot-climatic-variables-over-elevation"><i class="fa fa-check"></i><b>4.2</b> Plot climatic variables over elevation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="landcover-in-relation-to-elevation.html"><a href="landcover-in-relation-to-elevation.html"><i class="fa fa-check"></i><b>5</b> Landcover in relation to elevation</a><ul>
<li class="chapter" data-level="5.1" data-path="landcover-in-relation-to-elevation.html"><a href="landcover-in-relation-to-elevation.html#get-data-from-landscape-rasters"><i class="fa fa-check"></i><b>5.1</b> Get data from landscape rasters</a></li>
<li class="chapter" data-level="5.2" data-path="landcover-in-relation-to-elevation.html"><a href="landcover-in-relation-to-elevation.html#plot-proportional-landcover-in-elevation"><i class="fa fa-check"></i><b>5.2</b> Plot proportional landcover in elevation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="climate-in-relation-to-landcover.html"><a href="climate-in-relation-to-landcover.html"><i class="fa fa-check"></i><b>6</b> Climate in relation to landcover</a><ul>
<li class="chapter" data-level="6.1" data-path="climate-in-relation-to-landcover.html"><a href="climate-in-relation-to-landcover.html#prepare-libraries-3"><i class="fa fa-check"></i><b>6.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="6.2" data-path="climate-in-relation-to-landcover.html"><a href="climate-in-relation-to-landcover.html#plot-climatic-variables-over-landcover"><i class="fa fa-check"></i><b>6.2</b> Plot climatic variables over landcover</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="obsever-expertise-in-time-and-space.html"><a href="obsever-expertise-in-time-and-space.html"><i class="fa fa-check"></i><b>7</b> Obsever expertise in time and space</a><ul>
<li class="chapter" data-level="7.1" data-path="obsever-expertise-in-time-and-space.html"><a href="obsever-expertise-in-time-and-space.html#prepare-libraries-4"><i class="fa fa-check"></i><b>7.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="7.2" data-path="obsever-expertise-in-time-and-space.html"><a href="obsever-expertise-in-time-and-space.html#species-seen-in-relation-to-osberver-expertise"><i class="fa fa-check"></i><b>7.2</b> Species seen in relation to osberver expertise</a></li>
<li class="chapter" data-level="7.3" data-path="obsever-expertise-in-time-and-space.html"><a href="obsever-expertise-in-time-and-space.html#expertise-in-relation-to-landcover"><i class="fa fa-check"></i><b>7.3</b> Expertise in relation to landcover</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-autocorrelation-in-climatic-predictors.html"><a href="spatial-autocorrelation-in-climatic-predictors.html"><i class="fa fa-check"></i><b>8</b> Spatial autocorrelation in climatic predictors</a><ul>
<li class="chapter" data-level="8.1" data-path="spatial-autocorrelation-in-climatic-predictors.html"><a href="spatial-autocorrelation-in-climatic-predictors.html#load-libs-and-prep-data"><i class="fa fa-check"></i><b>8.1</b> Load libs and prep data</a></li>
<li class="chapter" data-level="8.2" data-path="spatial-autocorrelation-in-climatic-predictors.html"><a href="spatial-autocorrelation-in-climatic-predictors.html#calculate-variograms"><i class="fa fa-check"></i><b>8.2</b> Calculate variograms</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-autocorrelation-in-climatic-predictors.html"><a href="spatial-autocorrelation-in-climatic-predictors.html#plot-chelsa-data-and-variograms"><i class="fa fa-check"></i><b>8.3</b> Plot CHELSA data and variograms</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="climatic-raster-resampling.html"><a href="climatic-raster-resampling.html"><i class="fa fa-check"></i><b>9</b> Climatic raster resampling</a><ul>
<li class="chapter" data-level="9.1" data-path="climatic-raster-resampling.html"><a href="climatic-raster-resampling.html#prepare-landcover"><i class="fa fa-check"></i><b>9.1</b> Prepare landcover</a></li>
<li class="chapter" data-level="9.2" data-path="climatic-raster-resampling.html"><a href="climatic-raster-resampling.html#prepare-spatial-extent"><i class="fa fa-check"></i><b>9.2</b> Prepare spatial extent</a></li>
<li class="chapter" data-level="9.3" data-path="climatic-raster-resampling.html"><a href="climatic-raster-resampling.html#prepare-chelsa-rasters"><i class="fa fa-check"></i><b>9.3</b> Prepare CHELSA rasters</a></li>
<li class="chapter" data-level="9.4" data-path="climatic-raster-resampling.html"><a href="climatic-raster-resampling.html#resample-prepared-rasters"><i class="fa fa-check"></i><b>9.4</b> Resample prepared rasters</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="matching-effort-with-spatial-independence.html"><a href="matching-effort-with-spatial-independence.html"><i class="fa fa-check"></i><b>10</b> Matching effort with spatial independence</a><ul>
<li class="chapter" data-level="10.1" data-path="matching-effort-with-spatial-independence.html"><a href="matching-effort-with-spatial-independence.html#load-librarires"><i class="fa fa-check"></i><b>10.1</b> Load librarires</a></li>
<li class="chapter" data-level="10.2" data-path="matching-effort-with-spatial-independence.html"><a href="matching-effort-with-spatial-independence.html#load-data"><i class="fa fa-check"></i><b>10.2</b> Load data</a></li>
<li class="chapter" data-level="10.3" data-path="matching-effort-with-spatial-independence.html"><a href="matching-effort-with-spatial-independence.html#plot-distance-exclusion-effect"><i class="fa fa-check"></i><b>10.3</b> Plot distance exclusion effect</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html"><i class="fa fa-check"></i><b>11</b> Spatial thinning: A comparison of approaches</a><ul>
<li class="chapter" data-level="11.1" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#prepare-libraries-5"><i class="fa fa-check"></i><b>11.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="11.2" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#traditional-grid-based-thinning"><i class="fa fa-check"></i><b>11.2</b> Traditional grid-based thinning</a></li>
<li class="chapter" data-level="11.3" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#network-based-thinning"><i class="fa fa-check"></i><b>11.3</b> Network-based thinning</a></li>
<li class="chapter" data-level="11.4" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#finding-modularity-in-proximity-networks"><i class="fa fa-check"></i><b>11.4</b> Finding modularity in proximity networks</a></li>
<li class="chapter" data-level="11.5" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#process-proximity-networks-in-r"><i class="fa fa-check"></i><b>11.5</b> Process proximity networks in R</a></li>
<li class="chapter" data-level="11.6" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#a-function-that-removes-sites"><i class="fa fa-check"></i><b>11.6</b> A function that removes sites</a></li>
<li class="chapter" data-level="11.7" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#removing-non-independent-sites"><i class="fa fa-check"></i><b>11.7</b> Removing non-independent sites</a></li>
<li class="chapter" data-level="11.8" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#measuring-method-fallibility"><i class="fa fa-check"></i><b>11.8</b> Measuring method fallibility</a></li>
<li class="chapter" data-level="11.9" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#prepare-data-for-python"><i class="fa fa-check"></i><b>11.9</b> Prepare data for Python</a></li>
<li class="chapter" data-level="11.10" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#count-props-under-threshold-in-python"><i class="fa fa-check"></i><b>11.10</b> Count props under threshold in Python</a></li>
<li class="chapter" data-level="11.11" data-path="spatial-thinning-a-comparison-of-approaches.html"><a href="spatial-thinning-a-comparison-of-approaches.html#plot-metrics-for-different-methods"><i class="fa fa-check"></i><b>11.11</b> Plot metrics for different methods</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supplementary material for: Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="species-observation-distributions" class="section level1">
<h1><span class="header-section-number">Section 3</span> Species observation distributions</h1>
<div id="prepare-libraries-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Prepare libraries</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># load libraries</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb18-6" title="6"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb18-8" title="8"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb18-9" title="9"></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb18-11" title="11"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb18-12" title="12"><span class="kw">library</span>(scico)</a>
<a class="sourceLine" id="cb18-13" title="13"></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co"># round any function</span></a>
<a class="sourceLine" id="cb18-15" title="15">round_any &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">accuracy =</span> <span class="dv">25000</span>){<span class="kw">round</span>(x<span class="op">/</span>accuracy)<span class="op">*</span>accuracy}</a></code></pre></div>
</div>
<div id="read-species-of-interest" class="section level2">
<h2><span class="header-section-number">3.2</span> Read species of interest</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># add species of interest</span></a>
<a class="sourceLine" id="cb19-2" title="2">specieslist &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/species_list.csv&quot;</span>)</a>
<a class="sourceLine" id="cb19-3" title="3">speciesOfInterest &lt;-<span class="st"> </span>specieslist<span class="op">$</span>scientific_name</a></code></pre></div>
</div>
<div id="load-raw-data-for-locations" class="section level2">
<h2><span class="header-section-number">3.3</span> Load raw data for locations</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># read in shapefile of the study area to subset by bounding box</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb20-3" title="3">wg &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/spatial/hillsShapefile/Nil_Ana_Pal.shp&quot;</span>); box &lt;-<span class="st"> </span><span class="kw">st_bbox</span>(wg)</a>
<a class="sourceLine" id="cb20-4" title="4"></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co"># read in data and subset</span></a>
<a class="sourceLine" id="cb20-6" title="6">ebd &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;data/eBirdDataWG_filtered.txt&quot;</span>)</a>
<a class="sourceLine" id="cb20-7" title="7">ebd &lt;-<span class="st"> </span>ebd[<span class="kw">between</span>(LONGITUDE, box[<span class="st">&quot;xmin&quot;</span>], box[<span class="st">&quot;xmax&quot;</span>]) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="st">            </span><span class="kw">between</span>(LATITUDE, box[<span class="st">&quot;ymin&quot;</span>], box[<span class="st">&quot;ymax&quot;</span>]),]</a>
<a class="sourceLine" id="cb20-9" title="9">ebd &lt;-<span class="st"> </span>ebd[<span class="kw">year</span>(<span class="st">`</span><span class="dt">OBSERVATION DATE</span><span class="st">`</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2013</span>,]</a>
<a class="sourceLine" id="cb20-10" title="10"></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="co"># make new column names</span></a>
<a class="sourceLine" id="cb20-12" title="12">newNames &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(<span class="kw">colnames</span>(ebd), <span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-13" title="13"><span class="st">  </span><span class="kw">str_to_lower</span>()</a>
<a class="sourceLine" id="cb20-14" title="14"><span class="kw">setnames</span>(ebd, newNames)</a>
<a class="sourceLine" id="cb20-15" title="15"></a>
<a class="sourceLine" id="cb20-16" title="16"><span class="co"># keep useful columns</span></a>
<a class="sourceLine" id="cb20-17" title="17">columnsOfInterest &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;scientific_name&quot;</span>,<span class="st">&quot;observation_count&quot;</span>,<span class="st">&quot;locality&quot;</span>,</a>
<a class="sourceLine" id="cb20-18" title="18">    <span class="st">&quot;locality_id&quot;</span>,<span class="st">&quot;locality_type&quot;</span>,<span class="st">&quot;latitude&quot;</span>,<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;observation_date&quot;</span>, <span class="st">&quot;sampling_event_identifier&quot;</span>)</a>
<a class="sourceLine" id="cb20-19" title="19"></a>
<a class="sourceLine" id="cb20-20" title="20">ebd &lt;-<span class="st"> </span>ebd[, ..columnsOfInterest]</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># strict spatial filter and assign grid</span></a>
<a class="sourceLine" id="cb21-2" title="2">locs &lt;-<span class="st"> </span>ebd[,.(longitude, latitude)]</a>
<a class="sourceLine" id="cb21-3" title="3"></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co"># transform to UTM and get 20km boxes</span></a>
<a class="sourceLine" id="cb21-5" title="5">coords &lt;-<span class="st"> </span><span class="kw">setDF</span>(locs) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="st">  `</span><span class="dt">st_crs&lt;-</span><span class="st">`</span>(<span class="dv">4326</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">as.data.table</span>(<span class="kw">st_coordinates</span>(.))) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.))</a>
<a class="sourceLine" id="cb21-11" title="11"></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="co"># convert wg to UTM for filter</span></a>
<a class="sourceLine" id="cb21-13" title="13">wg &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wg, <span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb21-14" title="14">coords &lt;-<span class="st"> </span>coords <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="st">  </span><span class="kw">filter</span>(id <span class="op">%in%</span><span class="st"> </span><span class="kw">unlist</span>(<span class="kw">st_contains</span>(wg, coords))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">longitude =</span> X, <span class="dt">latitude =</span> Y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-17" title="17"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">as.data.table</span>(<span class="kw">st_coordinates</span>(.))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-18" title="18"><span class="st">  </span><span class="kw">st_drop_geometry</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-19" title="19"><span class="st">  </span><span class="kw">as.data.table</span>()</a>
<a class="sourceLine" id="cb21-20" title="20"></a>
<a class="sourceLine" id="cb21-21" title="21"><span class="co"># remove unneeded objs</span></a>
<a class="sourceLine" id="cb21-22" title="22"><span class="kw">rm</span>(locs); <span class="kw">gc</span>()</a>
<a class="sourceLine" id="cb21-23" title="23"></a>
<a class="sourceLine" id="cb21-24" title="24">coords &lt;-<span class="st"> </span>coords[,.N,by=.(longitude, latitude, X, Y)]</a>
<a class="sourceLine" id="cb21-25" title="25"></a>
<a class="sourceLine" id="cb21-26" title="26">ebd &lt;-<span class="st"> </span><span class="kw">merge</span>(ebd, coords, <span class="dt">all =</span> <span class="ot">FALSE</span>, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>))</a>
<a class="sourceLine" id="cb21-27" title="27"></a>
<a class="sourceLine" id="cb21-28" title="28">ebd &lt;-<span class="st"> </span>ebd[(longitude <span class="op">%in%</span><span class="st"> </span>coords<span class="op">$</span>longitude) <span class="op">&amp;</span><span class="st"> </span>(latitude <span class="op">%in%</span><span class="st"> </span>coords<span class="op">$</span>latitude),]</a></code></pre></div>
</div>
<div id="get-proportional-obs-counts-in-25km-cells" class="section level2">
<h2><span class="header-section-number">3.4</span> Get proportional obs counts in 25km cells</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># round to 25km cell in UTM coords</span></a>
<a class="sourceLine" id="cb22-2" title="2">ebd[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(<span class="dt">X =</span> <span class="kw">round_any</span>(X), <span class="dt">Y =</span> <span class="kw">round_any</span>(Y))]</a>
<a class="sourceLine" id="cb22-3" title="3"></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co"># count checklists in cell</span></a>
<a class="sourceLine" id="cb22-5" title="5">ebd_summary &lt;-<span class="st"> </span>ebd[,nchk <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(sampling_event_identifier)), by=.(X,Y)]</a>
<a class="sourceLine" id="cb22-6" title="6"></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co"># count checklists reporting each species in cell and get proportion</span></a>
<a class="sourceLine" id="cb22-8" title="8">ebd_summary &lt;-<span class="st"> </span>ebd_summary[,.(<span class="dt">nrep =</span> <span class="kw">length</span>(<span class="kw">unique</span>(sampling_event_identifier))),</a>
<a class="sourceLine" id="cb22-9" title="9">   by =<span class="st"> </span>.(X,Y,nchk,scientific_name)]</a>
<a class="sourceLine" id="cb22-10" title="10"></a>
<a class="sourceLine" id="cb22-11" title="11">ebd_summary[,p_rep <span class="op">:</span><span class="er">=</span><span class="st"> </span>nrep<span class="op">/</span>nchk ]</a>
<a class="sourceLine" id="cb22-12" title="12"></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="co"># filter for soi</span></a>
<a class="sourceLine" id="cb22-14" title="14">ebd_summary &lt;-<span class="st"> </span>ebd_summary[scientific_name <span class="op">%in%</span><span class="st"> </span>speciesOfInterest,]</a>
<a class="sourceLine" id="cb22-15" title="15"></a>
<a class="sourceLine" id="cb22-16" title="16"><span class="co"># complete the dataframe for no reports</span></a>
<a class="sourceLine" id="cb22-17" title="17"><span class="co"># keep no reports as NA --- allows filtering based on proportion reporting</span></a>
<a class="sourceLine" id="cb22-18" title="18">ebd_summary &lt;-<span class="st"> </span><span class="kw">setDF</span>(ebd_summary) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-19" title="19"><span class="st">  </span><span class="kw">complete</span>(<span class="kw">nesting</span>(X,Y), scientific_name <span class="co">#, </span></a>
<a class="sourceLine" id="cb22-20" title="20">    <span class="co"># fill = list(p_rep = 0)</span></a>
<a class="sourceLine" id="cb22-21" title="21">    ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-22" title="22"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(p_rep))</a></code></pre></div>
</div>
<div id="which-species-are-reported-sufficiently-in-checklists" class="section level2">
<h2><span class="header-section-number">3.5</span> Which species are reported sufficiently in checklists?</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># A total of 42 unique grids (of 25km by 25km) across the study area</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co"># total number of checklists across unique grids</span></a>
<a class="sourceLine" id="cb23-3" title="3"></a>
<a class="sourceLine" id="cb23-4" title="4">tot_n_chklist &lt;-<span class="st"> </span>ebd_summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="st">    </span><span class="kw">distinct</span>(X,Y,nchk)</a>
<a class="sourceLine" id="cb23-6" title="6"></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="co"># species-specific number of grids</span></a>
<a class="sourceLine" id="cb23-8" title="8">spp_grids &lt;-<span class="st"> </span>ebd_summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="st">          </span><span class="kw">group_by</span>(scientific_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="st">          </span><span class="kw">distinct</span>(X,Y) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="st">          </span><span class="kw">count</span>(scientific_name,</a>
<a class="sourceLine" id="cb23-12" title="12">                <span class="dt">name =</span> <span class="st">&quot;n_grids&quot;</span>)</a>
<a class="sourceLine" id="cb23-13" title="13"></a>
<a class="sourceLine" id="cb23-14" title="14"><span class="co"># Write the above two results</span></a>
<a class="sourceLine" id="cb23-15" title="15"><span class="kw">write_csv</span>(tot_n_chklist,<span class="st">&quot;data/nchk_per_grid.csv&quot;</span>)</a>
<a class="sourceLine" id="cb23-16" title="16"><span class="kw">write_csv</span>(spp_grids,<span class="st">&quot;data/ngrids_per_spp.csv&quot;</span>)</a>
<a class="sourceLine" id="cb23-17" title="17"></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="co"># left-join the datasets</span></a>
<a class="sourceLine" id="cb23-19" title="19">ebd_summary &lt;-<span class="st"> </span><span class="kw">left_join</span>(ebd_summary, spp_grids, <span class="dt">by=</span><span class="st">&quot;scientific_name&quot;</span>)</a>
<a class="sourceLine" id="cb23-20" title="20"></a>
<a class="sourceLine" id="cb23-21" title="21"><span class="co"># check the proportion of grids across which this cut-off is met for each species</span></a>
<a class="sourceLine" id="cb23-22" title="22"><span class="co"># Is it &gt; 90% or 70%?</span></a>
<a class="sourceLine" id="cb23-23" title="23"><span class="co"># For example, with a 3% cut-off, ~100 species are occurring in &gt;50% of the grids they have been reported in</span></a>
<a class="sourceLine" id="cb23-24" title="24"></a>
<a class="sourceLine" id="cb23-25" title="25">p_cutoff &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co"># Proportion of checklists a species has been reported in</span></a>
<a class="sourceLine" id="cb23-26" title="26">grid_proportions &lt;-<span class="st"> </span>ebd_summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-27" title="27"><span class="st">          </span><span class="kw">group_by</span>(scientific_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-28" title="28"><span class="st">          </span><span class="kw">tally</span>(p_rep<span class="op">&gt;=</span>p_cutoff) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-29" title="29"><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">prop_grids_cut =</span> n<span class="op">/</span>(spp_grids<span class="op">$</span>n_grids))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-30" title="30"><span class="st">          </span><span class="kw">arrange</span>(<span class="kw">desc</span>(prop_grids_cut))</a>
<a class="sourceLine" id="cb23-31" title="31"></a>
<a class="sourceLine" id="cb23-32" title="32">grid_prop_cut &lt;-<span class="st"> </span><span class="kw">filter</span>(grid_proportions,</a>
<a class="sourceLine" id="cb23-33" title="33">                        prop_grids_cut <span class="op">&gt;</span><span class="st"> </span>p_cutoff)</a>
<a class="sourceLine" id="cb23-34" title="34"></a>
<a class="sourceLine" id="cb23-35" title="35"><span class="co"># Write the results</span></a>
<a class="sourceLine" id="cb23-36" title="36"><span class="kw">write_csv</span>(grid_prop_cut, <span class="st">&quot;data/chk_3_percent.csv&quot;</span>)</a>
<a class="sourceLine" id="cb23-37" title="37"></a>
<a class="sourceLine" id="cb23-38" title="38"><span class="co"># Identifying the number of species that occur in potentially &lt;5% of all lists</span></a>
<a class="sourceLine" id="cb23-39" title="39">total_number_lists &lt;-<span class="st"> </span><span class="kw">sum</span>(tot_n_chklist<span class="op">$</span>nchk)</a>
<a class="sourceLine" id="cb23-40" title="40"></a>
<a class="sourceLine" id="cb23-41" title="41">spp_sum_chk &lt;-<span class="st"> </span>ebd_summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-42" title="42"><span class="st">  </span><span class="kw">distinct</span>(X,Y, scientific_name, nrep) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-43" title="43"><span class="st">  </span><span class="kw">group_by</span>(scientific_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-44" title="44"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sum_chk =</span> <span class="kw">sum</span>(nrep)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-45" title="45"><span class="st">  </span><span class="kw">distinct</span>(scientific_name,sum_chk)</a>
<a class="sourceLine" id="cb23-46" title="46"></a>
<a class="sourceLine" id="cb23-47" title="47"><span class="co"># Approximately 90 to 100 species occur in &gt;5% of all checklists</span></a>
<a class="sourceLine" id="cb23-48" title="48">prop_all_lists &lt;-<span class="st"> </span>spp_sum_chk <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-49" title="49"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">prop_lists =</span> sum_chk<span class="op">/</span>total_number_lists) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-50" title="50"><span class="st">      </span><span class="kw">arrange</span>(<span class="kw">desc</span>(prop_lists))</a></code></pre></div>
</div>
<div id="plot-maps" class="section level2">
<h2><span class="header-section-number">3.6</span> Plot maps</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># add land</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">library</span>(rnaturalearth)</a>
<a class="sourceLine" id="cb24-3" title="3">land &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="dv">50</span>, <span class="dt">type =</span> <span class="st">&quot;countries&quot;</span>, <span class="dt">continent =</span> <span class="st">&quot;asia&quot;</span>,</a>
<a class="sourceLine" id="cb24-4" title="4">                     <span class="dt">country =</span> <span class="st">&quot;india&quot;</span>,</a>
<a class="sourceLine" id="cb24-5" title="5">                     <span class="dt">returnclass =</span> <span class="kw">c</span>(<span class="st">&quot;sf&quot;</span>))</a>
<a class="sourceLine" id="cb24-6" title="6"></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co"># crop land</span></a>
<a class="sourceLine" id="cb24-8" title="8">land &lt;-<span class="st"> </span><span class="kw">st_transform</span>(land, <span class="dv">32643</span>)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># make plot</span></a>
<a class="sourceLine" id="cb25-2" title="2">wg &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wg, <span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb25-3" title="3">bbox &lt;-<span class="st"> </span><span class="kw">st_bbox</span>(wg)</a>
<a class="sourceLine" id="cb25-4" title="4"></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">#get a plot of number of checklists across grids</span></a>
<a class="sourceLine" id="cb25-6" title="6">plotNchk &lt;-</a>
<a class="sourceLine" id="cb25-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> land, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">data =</span> tot_n_chklist,</a>
<a class="sourceLine" id="cb25-10" title="10">            <span class="kw">aes</span>(X, Y, <span class="dt">fill =</span> nchk), <span class="dt">lwd =</span> <span class="fl">0.5</span>, <span class="dt">col =</span> <span class="st">&quot;grey90&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> wg, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="st">  </span><span class="kw">scale_fill_scico</span>(<span class="dt">palette =</span> <span class="st">&quot;lajolla&quot;</span>, </a>
<a class="sourceLine" id="cb25-13" title="13">                   <span class="dt">direction =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb25-14" title="14">                   <span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>,</a>
<a class="sourceLine" id="cb25-15" title="15">                   <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10000</span>),</a>
<a class="sourceLine" id="cb25-16" title="16">                   <span class="dt">breaks =</span> <span class="dv">10</span> <span class="op">^</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb25-17" title="17"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>)], <span class="dt">ylim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])<span class="op">+</span></a>
<a class="sourceLine" id="cb25-18" title="18"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb25-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, </a>
<a class="sourceLine" id="cb25-20" title="20">        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb25-21" title="21">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb25-22" title="22">        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb25-23" title="23"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;number</span><span class="ch">\n</span><span class="st">of</span><span class="ch">\n</span><span class="st">checklists&quot;</span>)</a>
<a class="sourceLine" id="cb25-24" title="24"></a>
<a class="sourceLine" id="cb25-25" title="25"><span class="co"># export data</span></a>
<a class="sourceLine" id="cb25-26" title="26"><span class="kw">ggsave</span>(plotNchk, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_number_checklists_10km.png&quot;</span>,<span class="dt">height =</span> <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb25-27" title="27">       <span class="dt">width =</span> <span class="dv">7</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a>
<a class="sourceLine" id="cb25-28" title="28"></a>
<a class="sourceLine" id="cb25-29" title="29"><span class="co"># filter list of species</span></a>
<a class="sourceLine" id="cb25-30" title="30">ebd_filter &lt;-<span class="st"> </span><span class="kw">semi_join</span>(ebd_summary, grid_prop_cut, <span class="dt">by=</span><span class="st">&quot;scientific_name&quot;</span>)</a>
<a class="sourceLine" id="cb25-31" title="31"></a>
<a class="sourceLine" id="cb25-32" title="32">plotDistributions &lt;-</a>
<a class="sourceLine" id="cb25-33" title="33"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb25-34" title="34"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> land, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-35" title="35"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">data =</span> ebd_filter,</a>
<a class="sourceLine" id="cb25-36" title="36">            <span class="kw">aes</span>(X, Y, <span class="dt">fill =</span> p_rep), <span class="dt">lwd =</span> <span class="fl">0.5</span>, <span class="dt">col =</span> <span class="st">&quot;grey90&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-37" title="37"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> wg, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-38" title="38"><span class="st">  </span></a>
<a class="sourceLine" id="cb25-39" title="39"><span class="st">  </span><span class="kw">scale_fill_scico</span>(<span class="dt">palette =</span> <span class="st">&quot;lajolla&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>, <span class="dt">label =</span> scales<span class="op">::</span>percent)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-40" title="40"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>scientific_name, <span class="dt">ncol =</span> <span class="dv">12</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-41" title="41"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>)], <span class="dt">ylim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])<span class="op">+</span></a>
<a class="sourceLine" id="cb25-42" title="42"><span class="st">  </span>ggthemes<span class="op">::</span><span class="kw">theme_few</span>(<span class="dt">base_family =</span> <span class="st">&quot;TT Arial&quot;</span>,</a>
<a class="sourceLine" id="cb25-43" title="43">                      <span class="dt">base_size =</span> <span class="dv">8</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-44" title="44"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>,</a>
<a class="sourceLine" id="cb25-45" title="45">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>),</a>
<a class="sourceLine" id="cb25-46" title="46">        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb25-47" title="47">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb25-48" title="48">        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb25-49" title="49"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;prop.</span><span class="ch">\n</span><span class="st">reporting</span><span class="ch">\n</span><span class="st">checklists&quot;</span>)</a>
<a class="sourceLine" id="cb25-50" title="50">  </a>
<a class="sourceLine" id="cb25-51" title="51"><span class="co"># export data</span></a>
<a class="sourceLine" id="cb25-52" title="52"><span class="kw">ggsave</span>(plotDistributions, </a>
<a class="sourceLine" id="cb25-53" title="53">       <span class="dt">filename =</span> <span class="st">&quot;figs/fig_species_distributions.png&quot;</span>,</a>
<a class="sourceLine" id="cb25-54" title="54">       <span class="dt">height =</span> <span class="dv">25</span>,<span class="dt">width =</span> <span class="dv">25</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="figure">
<img src="figs/fig_species_distributions.png" alt="Proportion of checklists reporting a species in each grid cell (20km side) between 2013 and 2018. Checklists were filtered to be within the boundaries of the Nilgiris, Anamalais and the Palani hills (black outline), but rounding to 20km cells may place cells outside the boundary. Deeper shades of red indicate a higher proportion of checklists reporting a species." />
<p class="caption">Proportion of checklists reporting a species in each grid cell (20km side) between 2013 and 2018. Checklists were filtered to be within the boundaries of the Nilgiris, Anamalais and the Palani hills (black outline), but rounding to 20km cells may place cells outside the boundary. Deeper shades of red indicate a higher proportion of checklists reporting a species.</p>
</div>
</div>
<div id="write-the-new-list-of-species" class="section level2">
<h2><span class="header-section-number">3.7</span> Write the new list of species</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># write the new list of species that occur in at least 3% of checklists across a minimum of 50% of the grids they have been reported in</span></a>
<a class="sourceLine" id="cb26-2" title="2"></a>
<a class="sourceLine" id="cb26-3" title="3">new_sp_list &lt;-<span class="st"> </span><span class="kw">semi_join</span>(specieslist,grid_prop_cut, <span class="dt">by=</span><span class="st">&quot;scientific_name&quot;</span>)</a>
<a class="sourceLine" id="cb26-4" title="4"></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="kw">write_csv</span>(new_sp_list,<span class="st">&quot;data/3_List_of_species_cutoff.csv&quot;</span>, <span class="dt">row.names =</span> F)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distance-to-roads.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="climate-in-relation-to-elevation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ebird_wghats-supplement.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
